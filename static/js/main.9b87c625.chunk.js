(this["webpackJsonp@bopen/leaflet-area-selection-example"]=this["webpackJsonp@bopen/leaflet-area-selection-example"]||[]).push([[0],[,,,function(t,e,n){t.exports=n.p+"static/media/B-Open.a8695c4b.svg"},,,function(t,e,n){t.exports=n(13)},,function(t,e,n){},function(t,e,n){},,,,function(t,e,n){"use strict";n.r(e);var a=n(2),i=(n(7),n(8),n(5)),o=n(1),r=n(4),s=n(0),c=["index"],l={leafletAreaSelectorControl:"_styles-module__leafletAreaSelectorControl__37qQG",leafletMapOverlayPane:"_styles-module__leafletMapOverlayPane__39tTo",drawPaneHelp:"_styles-module__drawPaneHelp__2Ftyt",endSelectionArea:"_styles-module__endSelectionArea__3Xj9O",areaSelectMarker:"_styles-module__areaSelectMarker__1h_hk",areaSelectGhostMarker:"_styles-module__areaSelectGhostMarker__1KD2U _styles-module__areaSelectMarker__1h_hk"};function d(t){return t.split("-").map((function(t,e){return 0===e?t:"".concat(t[0].toUpperCase()).concat(t.substring(1))})).join("")}function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=d(t);return l[n]?e?"".concat(l[n]," ").concat(t," ").concat(e):"".concat(l[n]," ").concat(t):e?"".concat(t," ").concat(e):t}function g(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=n?e.add(n):e;t._leaflet_pos=a,s.Browser.any3d?s.DomUtil.setTransform(t,a):(t.style.left=a.x+"px",t.style.top=a.y+"px")}var u=s.Browser.mobile?"touchend":"click";function m(t){return t.isTrusted||window.Cypress}var p="area-draw-selection";function v(t,e){var n,a,i=t.getContainer().querySelector(".leaflet-map-pane"),o=function(t){var e=t.active,n=t.fadeOnActivation;return s.DomUtil.create("div",h("leaflet-map-overlay-pane","leaflet-pane".concat(e?"":" inactive").concat(n?" fading-enabled":"")))}(e);n=o,(a=i).parentNode.insertBefore(n,a.nextSibling);var r=t.createPane(p,o);return r.addEventListener(u,(function(e){m(e)&&(e.stopPropagation(),t.fire("as:point-add",e))})),r}function f(t){var e=t.getMap().getPane(p).querySelector(".end-selection-area");e&&e.remove()}function k(t){t.originalEvent.preventDefault(),t.originalEvent.stopPropagation()}function y(t){var e=this;if(!this.mapMoving){var n=this.getMap(),a=t.clientX,i=t.clientY;if(void 0===a&&void 0===i){var c=t.changedTouches[0];a=c.clientX,i=c.clientY}if(this.rectDrawing&&null!==this.rectDrawEnd)n.fire("as:dragging-rect-end");else{var l=t.index,d=void 0===l?null:l,v=n.getContainer().getBoundingClientRect(),f=a-v.left,y=i-v.top;0===this.markers.length&&function(t,e){var n=Object(r.a)(e,2),a=n[0],i=n[1];console.log("yeeeey");var o=t.getMap(),c=o.getPane(p),l=s.DomUtil.create("div",h("end-selection-area"),c),d=l.getBoundingClientRect();l.setAttribute("role","button"),l.addEventListener(u,(function(t){m(t)&&(t.stopPropagation(),o.fire("as:creation-end"))}),{once:!0}),l.addEventListener("mouseenter",t.hoverClosePoint.bind(t)),l.addEventListener("mouseleave",t.outClosePoint.bind(t)),g(l,new s.Point(a,i),new s.Point(-d.width/2,-d.height/2))}(this,[f,y]);var L=new s.Point(f,y),w=new s.DivIcon({className:h("area-select-marker"),iconSize:[16,16]}),b=new s.Marker(n.containerPointToLatLng(L),{icon:w,draggable:!0}),_=D.bind(this);b.on("drag",_(null===d?this.markers.length:d)),b.on("dragstart",(function(t){t.target.getElement().classList.add("active")})),b.on("dragend",(function(t){t.target.getElement().classList.remove("active"),requestAnimationFrame((function(){e.onPolygonReady()}))}));var P,M={marker:b,index:d};if(b.on("dblclick",(P=this.markers.length,function(t){t.originalEvent.stopPropagation(),n.fire("as:marker-remove",Object(o.a)(Object(o.a)({},M),{},{index:null===d?P:d}))})),b.on(u,k),b.addTo(n),n.fire("as:marker-add",M),null!==d)for(var E=function(t){e.markers[t].marker.off("drag"),e.markers[t].marker.on("drag",_(t)),e.markers[t].marker.off(u),e.markers[t].marker.on(u,k),e.markers[t].marker.off("dblclick"),e.markers[t].marker.on("dblclick",(function(a){n.fire("as:marker-remove",Object(o.a)(Object(o.a)({},e.markers[t]),{},{index:t}))}))},S=d+1;S<this.markers.length;S++)E(S)}}}function L(t){var e=t.index,n=void 0===e?null:e,a=Object(i.a)(t,c),o=this.getMap(),r={marker:a.marker},l=this.markers;null===n?l.push(r):l.splice(n,0,r);var d=l.length>=3;"draw"===this.phase&&(d?3===l.length&&l.forEach((function(t,e){var n=t.marker,a=n.getIcon();a.options.className=h("area-select-marker",0===e?"start-marker":null),n.setIcon(a)})):l.forEach((function(t){var e=t.marker,n=e.getIcon();n.options.className=h("area-select-marker","invalid"),e.setIcon(n)}))),o.fire("as:update-polygon"),"adjust"===this.phase&&(o.fire("as:update-ghost-points"),this.onPolygonReady()),"draw"===this.phase&&(this.closeLine&&o.removeLayer(this.closeLine),d&&(this.closeLine=new s.Polyline([l[0].marker.getLatLng(),l[l.length-1].marker.getLatLng()],{weight:3,color:"#c0c0c0",className:"areaCloseLine"}),o.addLayer(this.closeLine)))}function w(t){var e=this,n=t.index,a=void 0===n?0:n,i=this.getMap();if(this.markers.length>3){this.markers.splice(a||0,1)[0].marker.removeFrom(i),i.fire("as:update-polygon"),"adjust"===this.phase&&i.fire("as:update-ghost-points");for(var r=function(t){e.markers[t].marker.off("drag"),e.markers[t].marker.on("drag",D.bind(e)(t)),e.markers[t].marker.off(u),e.markers[t].marker.on(u,k),e.markers[t].marker.off("dblclick"),e.markers[t].marker.on("dblclick",(function(n){n.originalEvent.stopPropagation(),i.fire("as:marker-remove",Object(o.a)(Object(o.a)({},e.markers[t]),{},{index:t}))}))},s=a;s<this.markers.length;s++)r(s);this.onPolygonReady()}}function b(){var t=this,e=this.getMap(),n=this.markers,a=n.length>=3,i=new s.Polygon(n.map((function(t){return t.marker.getLatLng()})),Object(o.a)(Object(o.a)({color:a?"rgb(45, 123, 200)":"rgba(220, 53, 69, 0.7)",weight:2},!a&&{dashArray:"5, 10"}),{},{className:"drawing-area-poligon"}));i.on(u,(function(t){s.DomEvent.stopPropagation(t)})),i.on("dblclick",(function(e){return s.DomEvent.stopPropagation(e),t.onPolygonDblClick(e),!1})),this.polygon&&e.removeLayer(this.polygon),this.polygon=i,e.addLayer(this.polygon)}function _(){var t=this,e=this.getMap();requestAnimationFrame((function(){t.clearGhostMarkers();var n=t.markers,a=t.ghostMarkers;n.forEach((function(i,o){var r=n[o+1]?n[o+1]:n[0],c=i.marker.getLatLng(),l=r.marker.getLatLng(),d=e.latLngToContainerPoint([(c.lat+l.lat)/2,(c.lng+l.lng)/2]),g=new s.DivIcon({className:h("area-select-ghost-marker"),iconSize:[16,16]}),m=new s.Marker(e.containerPointToLatLng(d),{icon:g,draggable:!0}),p={marker:m};m.on(u,k),m.on("dblclick",k),m.on("dragstart",S.bind(t)()),m.on("drag",E.bind(t)(a.length)),m.on("dragend",C.bind(t)(a.length)),a.push(p),m.addTo(e)}))}))}function P(){var t=this.getMap();t.dragging.enable(),t.removeLayer(this.closeLine),this.closeLine=null,this.markers[0].marker.getElement().classList.remove("start-marker"),this.setPhase("adjust"),t.fire("as:update-ghost-points"),this.onPolygonReady(),f(this)}function M(t){if(m(t)){var e=this.getMap();this._dragStatus=e.dragging._enabled,t.stopPropagation(),t.target.blur(),this.options.active||"adjust"===this.phase?(this._dragStatus||e.dragging.disable(),this.options.onButtonDeactivate(this.polygon,this,t),t.defaultPrevented||this.deactivate()):(this.options.onButtonActivate(this,t),t.defaultPrevented||this.activate())}}function D(t){var e=this.getMap();return function(t){requestAnimationFrame((function(){e.fire("as:update-polygon"),e.fire("as:update-ghost-points")}))}}function E(t){var e=this,n=this.getMap();return function(a){var i=a.latlng;requestAnimationFrame((function(){var a=e.markers[t],o=e.markers[t+1]?e.markers[t+1]:e.markers[0];e.ghostPolygon&&n.removeLayer(e.ghostPolygon),e.ghostPolygon=new s.Polygon([a.marker.getLatLng(),i,o.marker.getLatLng()],{color:"rgb(45, 123, 200)",weight:2,opacity:.5,fillOpacity:.1,dashArray:"5, 10"}),n.addLayer(e.ghostPolygon),n.fire("as:update-polygon")}))}}function S(){return function(t){t.target.getElement().classList.add("active")}}function C(t){var e=this,n=this.getMap();return function(a){var i=a.target;i.getElement().classList.remove("active"),i.removeFrom(n),e.ghostPolygon&&n.removeLayer(e.ghostPolygon);var o=n.latLngToContainerPoint(i.getLatLng()),r=n.getContainer().getBoundingClientRect(),s={clientX:o.x+r.left,clientY:o.y+r.top,index:t+1};n.fire("as:point-add",s)}}function O(t){if(!this.mapMoving&&0===this.markers.length&&0!==t.which&&1===t.buttons){var e=this.getMap();if(!this.rectDrawing){this.rectDrawStart=[t.clientX,t.clientY];var n={weight:2,color:"#8B4513",className:"rect-progress-line",opacity:.6};return this.draggingRect=(new s.LayerGroup).addLayer(new s.Polyline([],n)).addLayer(new s.Polyline([],n)).addTo(e),void(this.rectDrawing=!0)}this.rectDrawEnd=[t.clientX,t.clientY];var a=[this.rectDrawStart[0],t.clientY],i=[t.clientX,this.rectDrawStart[1]],o=this.draggingRect.getLayers();o[0].setLatLngs([e.mouseEventToLatLng({clientX:this.rectDrawEnd[0],clientY:this.rectDrawEnd[1]}),e.mouseEventToLatLng({clientX:a[0],clientY:a[1]}),e.mouseEventToLatLng({clientX:this.rectDrawStart[0],clientY:this.rectDrawStart[1]})]),o[1].setLatLngs([e.mouseEventToLatLng({clientX:this.rectDrawEnd[0],clientY:this.rectDrawEnd[1]}),e.mouseEventToLatLng({clientX:i[0],clientY:i[1]}),e.mouseEventToLatLng({clientX:this.rectDrawStart[0],clientY:this.rectDrawStart[1]})])}}function B(){this.rectDrawing=!1;var t={clientX:this.rectDrawStart[0],clientY:this.rectDrawStart[1]},e={clientX:this.rectDrawEnd[0],clientY:this.rectDrawStart[1]},n={clientX:this.rectDrawEnd[0],clientY:this.rectDrawEnd[1]},a={clientX:this.rectDrawStart[0],clientY:this.rectDrawEnd[1]};y.bind(this)(t),y.bind(this)(e),y.bind(this)(n),y.bind(this)(a),this._map.fire("as:creation-end"),this.rectDrawStart=null,this.rectDrawEnd=null,this.draggingRect.removeFrom(this._map)}var x=s.Control.extend({options:{active:!1,fadeOnActivation:!0,onPolygonReady:function(t,e){},onPolygonDblClick:function(t,e,n){},onButtonActivate:function(t,e){},onButtonDeactivate:function(t,e,n){}},initialize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s.Util.setOptions(this,t),this._map=null,this.phase=t.active?"draw":"inactive",this.mapMoving=!1,this.rectDrawing=!1,this.rectDrawStart=null,this.rectDrawEnd=null,this.draggingRect=null,this.markers=[],this.ghostMarkers=[],this.polygon=null,this.closeLine=null,this._mapMoveStart=this._mapMoveStart.bind(this),this._mapMoveEnd=this._mapMoveEnd.bind(this),this._handleMouseMove=this._handleMouseMove.bind(this)},onAdd:function(t){this._container=s.DomUtil.create("div",h("leaflet-area-selector-control")),this.activateButton=s.DomUtil.create("button","",this._container),this.activateButton.setAttribute("aria-label","Draw shape"),this.activateButton.setAttribute("aria-describedby","draw-panel-help"),this.activateButton.addEventListener("click",M.bind(this)),this.activateButton.addEventListener("dblclick",(function(t){t.stopPropagation()})),this.options.active?this.activateButton.classList.add("active"):this.activateButton.classList.remove("active"),this._map=t;var e=v(t,this.options);return this.addUserHelpPanel(e),t.getContainer().addEventListener("mousemove",this._handleMouseMove),t.on("movestart",this._mapMoveStart),t.on("moveend",this._mapMoveEnd),t.on("as:point-add",y.bind(this)),t.on("as:marker-add",L.bind(this)),t.on("as:marker-remove",w.bind(this)),t.on("as:creation-end",P.bind(this)),t.on("as:update-polygon",b.bind(this)),t.on("as:update-ghost-points",_.bind(this)),t.on("as:dragging-rect-end",B.bind(this)),this._container},onRemove:function(t){t.getContainer().removeEventListener("mousemove",this._handleMouseMove),t.off("movestart",this._mapMoveStart),t.off("moveend",this._mapMoveEnd),t.off("as:point-add"),t.off("as:marker-add"),t.off("as:marker-remove"),t.off("as:creation-end"),t.off("as:update-polygon"),t.off("as:update-ghost-points"),t.off("as:dragging-rect-end")},getMap:function(){return this._map},onPolygonReady:function(){this.options.onPolygonReady(this.polygon,this)},onPolygonDblClick:function(t){this.options.onPolygonDblClick(this.polygon,this,t)},addUserHelpPanel:function(t){var e=s.DomUtil.create("div",h("draw-pane-help"));e.setAttribute("id","draw-panel-help"),e.setAttribute("role","tooltip");var n="Define a polygon by clicking of the map to define vertexes".concat(s.Browser.mobile?".":" or click-and-drag to obtain a rectangular shape.");e.textContent=n,t.appendChild(e)},setPhase:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.phase=t,this.options.active="draw"===t,(e||"draw"===this.phase)&&(this.clearGhostMarkers(),this.clearMarkers(),this.clearPolygon());var n=this._map.getPane(p),a=n.parentNode;this.options.active?a.classList.remove("inactive"):a.classList.add("inactive")},_mapMoveStart:function(){this.options.active&&(this.mapMoving=!0)},_mapMoveEnd:function(){var t=this;if(this.options.active){var e=this._map;requestAnimationFrame((function(){t.mapMoving=!1}));var n=e.getPane(p).querySelector(".end-selection-area");if(n){var a=this.markers[0].marker,i=n.getBoundingClientRect();g(n,e.latLngToContainerPoint(a.getLatLng()),new s.Point(-i.width/2,-i.height/2))}}},hoverClosePoint:function(t){this.markers.length>2&&this.closeLine&&this.closeLine.removeFrom(this._map)},outClosePoint:function(t){this.closeLine&&this.closeLine.addTo(this._map)},clearMarkers:function(){var t=this;this.markers.forEach((function(e){e.marker.removeFrom(t._map)})),this.markers=[]},clearGhostMarkers:function(){var t=this;this.ghostMarkers.forEach((function(e){e.marker.removeFrom(t._map)})),this.ghostMarkers=[]},clearPolygon:function(){this.polygon&&this.polygon.removeFrom(this._map),this.polygon=null,this.closeLine&&this.closeLine.removeFrom(this._map),this.closeLine=null},deactivate:function(){f(this),this.activateButton.classList.remove("active"),this._map.getContainer().classList.remove("drawing-area"),this.setPhase("inactive",!0)},activate:function(){this._map.dragging.disable(),this.activateButton.classList.add("active"),this._map.getContainer().classList.add("drawing-area"),this.setPhase("draw",!0)},_handleMouseMove:function(t){this.options.active&&O.bind(this)(t)}});s.Util.extend(s.Control,{DrawAreaSelection:x,drawAreaSelection:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new x(t)}});n(9);var A=n(3),T=n.n(A);delete a.Icon.Default.prototype._getIconUrl,a.Icon.Default.mergeOptions({iconRetinaUrl:n(10),iconUrl:n(11),shadowUrl:n(12)});var j=[41.901493,12.5009157],R=new a.Map("root",{tap:!1,dragging:!a.Browser.mobile}).setView(j,13);Object(a.tileLayer)("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).on("load",(function(){window.MAP_LOADED=!0})).addTo(R);var X=document.createElement("div");X.innerHTML='<div style="text-align: center; font-size: 120%">B-Open</div>\n<img alt="B-Open logo" width="75" src="'.concat(T.a,'" />\n'),Object(a.marker)(j).addTo(R).bindPopup(X);var U=new x({onPolygonReady:function(t){var e=document.getElementById("polygon");e.textContent=JSON.stringify(t.toGeoJSON(3),void 0,2),e.scrollTop=e.scrollHeight},onPolygonDblClick:function(t,e,n){Object(a.geoJSON)(t.toGeoJSON(),{style:{opacity:.5,fillOpacity:.2,color:"red"}}).addTo(R),e.deactivate()},onButtonActivate:function(){document.getElementById("polygon").textContent="Please, draw your polygon",console.log("Please, draw your polygon")},onButtonDeactivate:function(t){var e=document.getElementById("polygon");console.log("Deactivated"),e.textContent="Deactivated! Current polygon is:\n\n".concat(t?JSON.stringify(t.toGeoJSON(3),void 0,2):"null")},position:"topleft"});R.addControl(U),document.querySelector("#control").addEventListener("click",(function(){"inactive"!==U.phase?U.deactivate():U.activate()}))}],[[6,1,2]]]);
//# sourceMappingURL=main.9b87c625.chunk.js.map